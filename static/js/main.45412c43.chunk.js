(this["webpackJsonpreact-ecommerce-frontend"]=this["webpackJsonpreact-ecommerce-frontend"]||[]).push([[0],{14:function(e,t,a){var n;n="https://node-ecommerce-backend.herokuapp.com",e.exports={PRODUCTS_URL:n+"/products",LOGIN_URL:n+"/login"}},39:function(e,t,a){},44:function(e,t,a){e.exports=a(86)},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},69:function(e,t,a){},75:function(e,t,a){},78:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t){},86:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(40),l=a.n(c),o=(a(49),a(18)),i=a(19),m=a(24),s=a(23),u=(a(50),a(51),a(5)),d=a(2),p=a(11),E=a.n(p),g=a(3),v=Object(n.createContext)(),f=function(e){var t=e.reducer,a=e.initialState,c=e.children;return r.a.createElement(v.Provider,{value:Object(n.useReducer)(t,a)},c)},h=function(){return Object(n.useContext)(v)},b=a(14);a(69);var y=function(){var e=Object(n.useState)([]),t=Object(g.a)(e,2),a=t[0],c=t[1],l=h(),o=Object(g.a)(l,2),i=(o[0].cart,o[1]);return Object(n.useEffect)((function(){E.a.get(b.PRODUCTS_URL).then((function(e){console.log("Sent request for products data to backend",e.data),c(e.data)})).catch((function(e){return console.log(e)})),console.log("Products mounted!")}),[]),r.a.createElement("div",null,r.a.createElement("ul",{className:"products"},a.map((function(e){return r.a.createElement("li",{key:e._id},r.a.createElement("div",{className:"product"},r.a.createElement(u.b,{to:"".concat(/products/,e._id)},r.a.createElement("img",{className:"product-image",src:e.image,alt:e.name})),r.a.createElement("div",{className:"product-name"},r.a.createElement(u.b,{to:"".concat(/products/,e._id)},e.name)),r.a.createElement("div",{className:"product-brand"},e.brand),r.a.createElement("div",{className:"product-price"},"$",e.price),r.a.createElement("div",{className:"product-rating"},e.rating," Stars(",e.numReviews," Reviews)"),r.a.createElement("button",{onClick:function(){return function(e){i({type:"ADD_TO_CART",item:{product:e._id,name:e.name,image:e.image,price:e.price,quantity:e.quantity,rating:e.rating}})}(e)}},"Add to cart")))}))))},O=(a(75),a(41)),N=a.n(O);var j=function(e){var t=h(),a=Object(g.a)(t,1)[0].cart;return r.a.createElement("nav",{className:"header"},r.a.createElement(u.b,{to:"/"},r.a.createElement("img",{className:"header_logo",src:"images/logo.svg",alt:"shopping cart logo"})),r.a.createElement("div",null,r.a.createElement("h3",null,"Mercadillo")),r.a.createElement("div",{className:"header_nav"},void 0!==e.currentUser.name?r.a.createElement("span",null,r.a.createElement("span",null,"Hello, ",e.currentUser.name," "),r.a.createElement("a",{href:"#",onClick:function(t){e.onLogout(t),e.history.push("/login")}},"Logout"," ")):r.a.createElement(u.b,{to:"/login"},r.a.createElement("span",null,"Sign in")),r.a.createElement(u.b,{to:"/cart"},r.a.createElement("div",{className:"header_optionCart"}),r.a.createElement(N.a,null),r.a.createElement("span",{className:"header_cartCount"},null===a||void 0===a?void 0:a.length))))};a(39),a(78);var _=function(e){var t=e.name,a=e.id,n=e.price,c=e.image,l=e.qty,o=e.rating,i=h(),m=Object(g.a)(i,2),s=(m[0].cart,m[1]);return r.a.createElement("div",{className:"cartItem"},r.a.createElement("img",{src:c,className:"cartItem_image",alt:t}),r.a.createElement("div",{className:"cartItem_details"},r.a.createElement("p",{className:"cartItem_name"},t),r.a.createElement("p",null,"In stock: ",l),r.a.createElement("p",{className:"cartItem_price"},r.a.createElement("small",null,"$"),r.a.createElement("strong",null,n)),r.a.createElement("div",{className:"cartItem_rating"},r.a.createElement("p",null,"Rating: "),Array(o).fill().map((function(e,t){return r.a.createElement("p",null,"\u2b50\ufe0f")}))),r.a.createElement("button",{onClick:function(){s({type:"REMOVE_FROM_CART",id:a})}},"Remove item")))};a(79);var S=function(){var e=Object(d.e)(),t=h(),a=Object(g.a)(t,2),n=a[0].cart;return a[1],r.a.createElement("div",null,"Grandtotal: $",function(){var e=0;return n.forEach((function(t){e+=t.price})),e.toFixed(2)}(),r.a.createElement("div",{className:"button-group"},r.a.createElement("button",{className:"button-primary",onClick:function(t){return e.push("/payment")}},"Go to checkout"),r.a.createElement("button",{className:"button-danger"},"Clear cart")))};var C=function(){var e=h(),t=Object(g.a)(e,1)[0].cart;return r.a.createElement("div",{className:"cart"},r.a.createElement("div",{className:"cartItems"},0===(null===t||void 0===t?void 0:t.length)?r.a.createElement("div",null,r.a.createElement("h2",null,"Your shopping cart is empty"),r.a.createElement("p",null,'You have no items in your cart. To add, click "Add to cart" next to items.')):r.a.createElement("div",null,r.a.createElement("h2",null,"Shopping cart: "),null===t||void 0===t?void 0:t.map((function(e){return r.a.createElement(_,{name:e.name,id:e.id,price:e.price,qty:e.quantity,image:e.image,rating:e.rating})}))))," ",t.length>0&&r.a.createElement("div",{className:"cartTotal"},r.a.createElement(S,null)))},R=a(22),k=(a(80),a(81),function(e){Object(m.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={email:"robbie@ga.co",password:"chicken"},e.handleChange=function(t){e.setState(Object(R.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault(),E.a.post(b.LOGIN_URL,{email:e.state.email,password:e.state.password}).then((function(t){e.props.onLogin(t.data.token,t.data.user),e.props.history.push("/")})).catch((function(e){console.log("Authentication error: incorrect username or password. ",e)}))},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login_container"},r.a.createElement("h1",null,"Please sign in "),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"formGroup"},r.a.createElement("input",{type:"text",name:"email",placeholder:"Email",onChange:this.handleChange}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",onChange:this.handleChange}),r.a.createElement("div",null,r.a.createElement("button",{className:"button-primary"},"Sign in"),r.a.createElement("p",null,"OR:"),r.a.createElement("button",{className:"button-primary"},"Use default login credentials")),r.a.createElement("div",null,r.a.createElement("br",null)))))}}]),a}(r.a.Component)),w=(a(82),a(15)),A=a(27),I=a(17),L=function(e,t){switch(t.type){case"ADD_TO_CART":return Object(I.a)(Object(I.a)({},e),{},{cart:[].concat(Object(A.a)(e.cart),[t.item])});case"REMOVE_FROM_CART":var a=Object(A.a)(e.cart),n=e.cart.findIndex((function(e){return e.id===t.id}));return n>=0?a.splice(n,1):console.warn("Could not remove product (id: ".concat(t.id,") as ID was not found.")),Object(I.a)(Object(I.a)({},e),{},{cart:a});default:return e}};var U=function(e){var t=h(),a=Object(g.a)(t,2),c=a[0].cart,l=(a[1],Object(w.useStripe)(),Object(w.useElements)(),Object(n.useState)(!1)),o=Object(g.a)(l,2),i=o[0],m=(o[1],Object(n.useState)("")),s=Object(g.a)(m,2),d=s[0],p=(s[1],Object(n.useState)(null)),E=Object(g.a)(p,2),v=(E[0],E[1]),f=Object(n.useState)(!0),b=Object(g.a)(f,2),y=b[0],O=b[1];return r.a.createElement("div",{className:"payment"},r.a.createElement("div",{className:"payment_container"},r.a.createElement("h1",null,"Checkout (",r.a.createElement(u.b,{to:"/cart"},null===c||void 0===c?void 0:c.length," items"),")"),r.a.createElement("div",{className:"payment_section"},r.a.createElement("div",{className:"payment_title"},r.a.createElement("h3",null,"Delivery address")),r.a.createElement("div",{className:"payment_address"},r.a.createElement("p",null,e.currentUser.name," (",e.currentUser.email,")"),r.a.createElement("p",null,e.currentUser.address),r.a.createElement("p",null,"Sydney, Australia"))),r.a.createElement("div",{className:"payment_section"},r.a.createElement("div",{className:"payment_title"},r.a.createElement("h3",null,"Review items and delivery")),c.map((function(e){return r.a.createElement(_,{name:e.name,id:e.id,qty:e.quantity,price:e.price,image:e.image,rating:e.rating})}))),r.a.createElement("div",{className:"payment_section"},r.a.createElement("div",{className:"payment_title"},r.a.createElement("h3",null,"Payment method")),r.a.createElement("div",{className:"payment_details"},r.a.createElement("form",{onSubmit:function(e){}},r.a.createElement(w.CardElement,{onChange:function(e){O(e.empty),v(e.error?e.error.message:"")}}),r.a.createElement("div",{className:"payment_priceContainer"},r.a.createElement("p",null,"Total to be charged: "),r.a.createElement("button",{disabled:d||y||i},r.a.createElement("span",null,d?r.a.createElement("p",null,"Processing"):"Buy Now"," "))))))))};a(83);function D(e){var t=Object(n.useState)({name:"",category:"",image:"",price:"",brand:"",rating:"",quantity:"",numReviews:"",description:""}),a=Object(g.a)(t,2),c=a[0],l=a[1],o=h(),i=Object(g.a)(o,2),m=(i[0].cart,i[1]);Object(n.useEffect)((function(){E.a.get("".concat(b.PRODUCTS_URL,"/").concat(e.match.params.id)).then((function(e){console.log("matched product",e.data),l(e.data)})).catch((function(e){return console.log(e)})),console.log("Product component mounted!")}),[e.match]);return r.a.createElement("div",{className:"details"},r.a.createElement(u.b,{className:"back",to:"/"},"Back"),r.a.createElement("div",{className:"details"},r.a.createElement("div",{className:"details-image"},r.a.createElement("img",{src:c.image,alt:c.name})),r.a.createElement("div",{className:"details-info"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("h4",null,c.name)),r.a.createElement("li",null,c.rating," Stars (",c.numReviews," Reviews )"),r.a.createElement("li",null,r.a.createElement("strong",null,"Price: $",c.price," "))))),r.a.createElement("div",{className:"details-action"},r.a.createElement("ul",null,r.a.createElement("li",null,"Price: ",r.a.createElement("strong",null,"$",c.price)),r.a.createElement("li",null,"Stock levels: ",c.quantity>20?r.a.createElement("p",null,"High"):r.a.createElement("p",null,"Low")),r.a.createElement("li",null,r.a.createElement("button",{className:"button",onClick:function(){m({type:"ADD_TO_CART",item:{product:c._id,name:c.name,image:c.image,price:c.price,quantity:c.quantity,rating:c.rating}})}},"Add to cart")))))}a(84);var T=a(42),q=Object(T.a)("pk_test_51HUoMRErAewt7RL6NDXnnMAB1Qzx8LEq7baSaXT5fy11YQmsl8A2c2m4mzzeW5O3R4Nynlsdh5srVKDyNkNQ6vZZ00pyGr4vsZ"),x=function(e){Object(m.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={user:{},cart:[],cartCount:0},e.performLogin=function(t,a){E.a.defaults.headers.common.Authorization="Bearer ".concat(t),e.setState({user:a}),localStorage.setItem("token",t),localStorage.setItem("user",JSON.stringify(a))},e.performLogout=function(t){t.preventDefault(),delete E.a.defaults.headers.common.Authorization,localStorage.removeItem("token"),localStorage.removeItem("user"),e.setState({user:{}})},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("token"),t=localStorage.getItem("user");null!==e&&null!==t&&(this.setState({user:JSON.parse(t)}),E.a.defaults.headers.common.Authorization="Bearer ".concat(e));var a=localStorage.getItem("cart");null!==a&&this.setState({cart:JSON.parse(a)})}},{key:"render",value:function(){var e=this;return r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement(d.a,{path:"/",render:function(t){return r.a.createElement(j,Object.assign({},t,{onLogout:e.performLogout,currentUser:e.state.user}))}}),r.a.createElement(d.a,{exact:!0,path:"/login",render:function(t){return r.a.createElement(k,Object.assign({},t,{onLogin:e.performLogin}))}}),r.a.createElement("main",{className:"main"},r.a.createElement("div",null,r.a.createElement("br",null)),r.a.createElement("div",{className:"content"},r.a.createElement(d.a,{exact:!0,path:"/",component:y}),r.a.createElement(d.a,{exact:!0,path:"/products/:id",component:D}),r.a.createElement(d.a,{path:"/cart"},r.a.createElement(C,null)),r.a.createElement(d.a,{exact:!0,path:"/payment",render:function(t){return r.a.createElement(w.Elements,{stripe:q},r.a.createElement(U,Object.assign({},t,{currentUser:e.state.user})))}}))),r.a.createElement("footer",{className:"footer"},"Final project at General Assembly - by Robert Paul - rob@glo.id.au")))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(f,{initialState:{cart:[]},reducer:L},r.a.createElement(x,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,1,2]]]);
//# sourceMappingURL=main.45412c43.chunk.js.map